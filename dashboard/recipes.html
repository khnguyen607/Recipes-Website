<!DOCTYPE html>
<html lang="vi">

<head>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <title>MyRecipes</title>
    <link rel="icon" href="img/logo.png" type="image/png">

    <link rel="stylesheet" href="css/bootstrap1.min.css" />

    <link rel="stylesheet" href="vendors/themefy_icon/themify-icons.css" />

    <link rel="stylesheet" href="vendors/swiper_slider/css/swiper.min.css" />

    <link rel="stylesheet" href="vendors/select2/css/select2.min.css" />

    <link rel="stylesheet" href="vendors/niceselect/css/nice-select.css" />

    <link rel="stylesheet" href="vendors/owl_carousel/css/owl.carousel.css" />

    <link rel="stylesheet" href="vendors/gijgo/gijgo.min.css" />

    <link rel="stylesheet" href="vendors/font_awesome/css/all.min.css" />
    <link rel="stylesheet" href="vendors/tagsinput/tagsinput.css" />

    <link rel="stylesheet" href="vendors/datatable/css/jquery.dataTables.min.css" />
    <link rel="stylesheet" href="vendors/datatable/css/responsive.dataTables.min.css" />
    <link rel="stylesheet" href="vendors/datatable/css/buttons.dataTables.min.css" />

    <link rel="stylesheet" href="vendors/text_editor/summernote-bs4.css" />

    <link rel="stylesheet" href="vendors/morris/morris.css">

    <link rel="stylesheet" href="vendors/material_icon/material-icons.css" />

    <link rel="stylesheet" href="css/metisMenu.css">

    <link rel="stylesheet" href="css/style1.css" />
    <link rel="stylesheet" href="css/colors/default.css" id="colorSkinCSS">
</head>

<body class="crm_body_bg">
    <div id="sidebar"></div>
    <section class="main_content dashboard_part">
        <div class="container-fluid g-0"></div>

        <div class="main_content_iner ">
            <div class="container-fluid plr_30 body_white_bg pt_30">
                <div class="row justify-content-center">
                    <div class="col-md-12">
                        <div class="white_box QA_section">
                            <div class="white_box_tittle list_header">
                                <h4>Tổng hợp công thức</h4>
                                <div class="box_right d-flex lms_block">
                                    <div class="serach_field_2">
                                        <div class="search_inner">
                                            <form Active="#">
                                                <div class="search_field">
                                                    <input type="text" placeholder="Tìm bài viết hoặc Tác giả"
                                                        id="searchInput">
                                                </div>
                                                <button type="submit"> <i class="ti-search"></i> </button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row my-2">
                                <a href="?status=active" class="btn btn-outline-success col-md">Bài viết đã duyệt</a>
                                <a href="recipes.html" class="btn btn-outline-primary col-md">Tất cả</a>
                                <a href="?status=pending" class="btn btn-outline-warning col-md">Bài viết chờ duyệt</a>
                            </div>
                            <div class="QA_table recipes_table" id="dataTableExample">
                                <table class="table table-hover recipes_table">
                                    <thead>
                                        <tr>
                                            <th scope="col">Mã bài viết</th>
                                            <th scope="col">Bài viết</th>
                                            <th scope="col">Tác giả</th>
                                            <th scope="col">Ngày đăng</th>
                                            <th scope="col">Trạng thái</th>
                                            <th scope="col">Thao tác</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr data-bs-toggle="offcanvas" data-bs-target="#canvasview"
                                            aria-controls="offcanvasRight">
                                            <td>1</td>
                                            <td>
                                                <div class="d-flex align-items-center">
                                                    <div class="flex-shrink-0">
                                                        <img class="circle-rounded me-3" src="img/messages/1.png" alt
                                                            width="30" height="30">
                                                    </div>
                                                    <div class="flex-grow-1 ms-3">
                                                        <p>Mark Wiyns</p>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
                                                <p> Money Receipt</p>
                                            </td>
                                            <td>
                                                12:22 PM
                                            </td>
                                            <td><a class="status_btn">Đã duyệt</a></td>
                                            <td>
                                                <a href="#" style="display: none;"><svg
                                                        xmlns="http://www.w3.org/2000/svg" height="1em"
                                                        viewBox="0 0 576 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
                                                        <path
                                                            d="M96 80c0-26.5 21.5-48 48-48H432c26.5 0 48 21.5 48 48V384H96V80zm313 47c-9.4-9.4-24.6-9.4-33.9 0l-111 111-47-47c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l64 64c9.4 9.4 24.6 9.4 33.9 0L409 161c9.4-9.4 9.4-24.6 0-33.9zM0 336c0-26.5 21.5-48 48-48H64V416H512V288h16c26.5 0 48 21.5 48 48v96c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V336z" />
                                                    </svg></a>
                                                <a href="#"><svg xmlns="http://www.w3.org/2000/svg" height="1em"
                                                        viewBox="0 0 448 512">
                                                        <path
                                                            d="M135.2 17.7L128 32H32C14.3 32 0 46.3 0 64S14.3 96 32 96H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H320l-7.2-14.3C307.4 6.8 296.3 0 284.2 0H163.8c-12.1 0-23.2 6.8-28.6 17.7zM416 128H32L53.2 467c1.6 25.3 22.6 45 47.9 45H346.9c25.3 0 46.3-19.7 47.9-45L416 128z" />
                                                    </svg></a>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <div class="offcanvas offcanvas-end overflow-auto" tabindex="-1" id="canvasview"
                                    aria-labelledby="offcanvasRightLabel">
                                    <div class="offcanvas-header row">
                                        <a href="" class="my-2"><svg xmlns="http://www.w3.org/2000/svg" height="1em"
                                                viewBox="0 0 448 512">
                                                <path
                                                    d="M135.2 17.7L128 32H32C14.3 32 0 46.3 0 64S14.3 96 32 96H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H320l-7.2-14.3C307.4 6.8 296.3 0 284.2 0H163.8c-12.1 0-23.2 6.8-28.6 17.7zM416 128H32L53.2 467c1.6 25.3 22.6 45 47.9 45H346.9c25.3 0 46.3-19.7 47.9-45L416 128z" />
                                            </svg></a>
                                        <h3 id="offcanvasRightLabel">Công thức nấu: <strong>Thực phầm dinh
                                                dưỡng</strong></h3>
                                    </div>
                                    <div class="offcanvas-body" style="margin-top: -10%;">
                                        <h6>Tác giả: Nguyên</h6>
                                        <p>món ăn thú vị này giúp bạn có 1 làn da khỏe mạnh</p>
                                        <hr>
                                        <div class="row">
                                            <h5 class="d-flex justify-content-center">Nguyên liệu</h5>
                                            <ul class="list-group list-group-horizontal row"></ul>
                                        </div>
                                        <hr>
                                        <div class="row">
                                            <h5 class="d-flex justify-content-center">Các bước thực hiện</h5>
                                            <ol class="list-group list-group-numbered">
                                            </ol>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="footer_part">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-lg-12 col-sm-12">
                            <div class="footer_iner text-center">

                            </div>
                        </div>
                    </div>
                </div>
            </div>
    </section>

    <script>
        fetch('../backend/get_data.php?table=recipes__user')
            .then(response => response.json())
            .then(data => {
                var status = new URLSearchParams(window.location.search).get('status');
                if (status == 'active')
                    data = data.filter(function (number) {
                        return number.status == 1;
                    });
                else if (status == 'pending')
                    data = data.filter(function (number) {
                        return number.status == 0;
                    });
                DivtoClone = document.querySelector('table.recipes_table tbody tr').cloneNode(true)
                document.querySelector('table.recipes_table tbody tr').remove()
                canvas = document.querySelector('#canvasview').cloneNode(true)
                document.querySelector('#canvasview').remove()

                data.forEach(item => {
                    var cloneDiv = DivtoClone.cloneNode(true);
                    var cloneCanvas = canvas.cloneNode(true);
                    cloneDiv.innerHTML = cloneDiv.innerHTML.replace(/canvasview/g, "canvasview" + item.id);
                    cloneDiv.setAttribute('data-bs-target', '#canvasview' + item.id)

                    td = cloneDiv.querySelectorAll('td');
                    td[0].textContent = item.id;
                    td[1].querySelector('img').src = item.img;
                    td[1].querySelector('p').textContent = item.title;
                    td[2].querySelector('p').textContent = item.name;
                    td[3].textContent = item.time;
                    if (item.status == 1)
                        td[4].querySelector('a').textContent = 'Đã duyệt'
                    else {
                        td[4].querySelector('a').textContent = 'Chờ duyệt'
                        td[4].querySelector('a').classList.add('yellow_btn')
                    }
                    td[5].querySelectorAll('a')[1].href = `../backend/delete.php?recipe_id=` + item.id;
                    if (item.status == 0) {
                        td[5].querySelectorAll('a')[0].href = `../backend/edit.php?recipes_active=` + item.id;
                        td[5].querySelectorAll('a')[0].style.display = 'block'
                    }
                    document.querySelector('table.recipes_table tbody').appendChild(cloneDiv);

                    cloneCanvas.setAttribute('id', 'canvasview' + item.id)
                    cloneCanvas.querySelector('h3 strong').textContent = item.title
                    cloneCanvas.querySelector('h6').textContent = "Tác giả: " + item.id
                    cloneCanvas.querySelector('p').textContent = item.subtitle

                    item.ingredients.split("||").forEach(ingred => {
                        var ingreds = document.createElement('li');
                        ingreds.className = "list-group-item col-md";
                        ingreds.style.minWidth = "33.333%";
                        ingreds.textContent = ingred;
                        cloneCanvas.querySelector('.list-group-horizontal').appendChild(ingreds);
                    });

                    item.step.split("||").forEach(ingred => {
                        var ingreds = document.createElement('li');
                        ingreds.className = "list-group-item";
                        ingreds.textContent = ingred;
                        cloneCanvas.querySelector('.list-group-numbered').appendChild(ingreds);
                    });
                    document.querySelector('.QA_table.recipes_table').appendChild(cloneCanvas);
                });
            })
    </script>

    <script>
        // Lấy tham chiếu đến ô tìm kiếm
        var searchInput = document.getElementById("searchInput");

        // Lấy tham chiếu đến bảng và các hàng dữ liệu
        var table = document.getElementById("dataTableExample");
        var rows = table.getElementsByTagName("tr");

        // Bắt sự kiện người dùng nhập vào ô tìm kiếm
        searchInput.addEventListener("input", function () {
            var searchText = searchInput.value.toLowerCase();
            // Duyệt qua các hàng dữ liệu và ẩn hoặc hiển thị dựa trên kết quả tìm kiếm
            for (var i = 1; i < rows.length; i++) { // Bắt đầu từ 1 để bỏ qua hàng tiêu đề
                var row = rows[i];
                var shouldShowRow = false;

                // Duyệt qua tất cả các ô của hàng và kiểm tra xem chúng có chứa chuỗi tìm kiếm không
                for (var j = 0; j < row.cells.length - 1; j++) {
                    var cell = row.cells[j];
                    var cellText = cell.textContent.toLowerCase();

                    if (cellText.includes(searchText)) {
                        shouldShowRow = true;
                        break;
                    }
                }

                if (shouldShowRow) {
                    row.style.display = "";
                } else {
                    row.style.display = "none";
                }
            }
        });
    </script>
    <script src="js/jquery1-3.4.1.min.js"></script>

    <script src="js/popper1.min.js"></script>

    <script src="js/bootstrap1.min.js"></script>

    <script src="js/metisMenu.js"></script>

    <script src="vendors/count_up/jquery.waypoints.min.js"></script>

    <script src="vendors/chartlist/Chart.min.js"></script>

    <script src="vendors/count_up/jquery.counterup.min.js"></script>

    <script src="vendors/swiper_slider/js/swiper.min.js"></script>

    <script src="vendors/niceselect/js/jquery.nice-select.min.js"></script>

    <script src="vendors/owl_carousel/js/owl.carousel.min.js"></script>

    <script src="vendors/gijgo/gijgo.min.js"></script>

    <script src="vendors/datatable/js/jquery.dataTables.min.js"></script>
    <script src="vendors/datatable/js/dataTables.responsive.min.js"></script>
    <script src="vendors/datatable/js/dataTables.buttons.min.js"></script>
    <script src="vendors/datatable/js/buttons.flash.min.js"></script>
    <script src="vendors/datatable/js/jszip.min.js"></script>
    <script src="vendors/datatable/js/pdfmake.min.js"></script>
    <script src="vendors/datatable/js/vfs_fonts.js"></script>
    <script src="vendors/datatable/js/buttons.html5.min.js"></script>
    <script src="vendors/datatable/js/buttons.print.min.js"></script>
    <script src="js/chart.min.js"></script>

    <script src="vendors/progressbar/jquery.barfiller.js"></script>

    <script src="vendors/tagsinput/tagsinput.js"></script>

    <script src="vendors/text_editor/summernote-bs4.js"></script>
    <script src="vendors/apex_chart/apexcharts.js"></script>

    <script src="js/custom.js"></script>
</body>

</html>